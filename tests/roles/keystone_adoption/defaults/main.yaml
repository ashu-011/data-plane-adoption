---

keystone_patch: |
  spec:
    keystone:
      enabled: true
      apiOverride:
        route: {}
      template:
        customServiceConfig: |
          [token]
          expiration = 360000
        override:
          service:
            internal:
              metadata:
                annotations:
                  metallb.universe.tf/address-pool: internalapi
                  metallb.universe.tf/allow-shared-ip: internalapi
                  {% if ipv6_enabled | default(false) -%}
                  metallb.universe.tf/loadBalancerIPs: {{ internalapi_prefix_ipv6 | default('2620:cf:cf:bbbb') }}::50
                  {%- else -%}
                  metallb.universe.tf/loadBalancerIPs: {{ internalapi_prefix | default('172.17.0') }}.80
                  {%- endif %}

              spec:
                type: LoadBalancer
        databaseInstance: openstack
        secret: osp-secret
keystone_retry_delay: 30
